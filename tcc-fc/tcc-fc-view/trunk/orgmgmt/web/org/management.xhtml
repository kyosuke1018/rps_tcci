<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/generalPageTemplate.xhtml">
    <ui:define name="title">#{orgManagement.pageTitle}</ui:define>
    <ui:define name="head">
        <style type="text/css">
.inactive {color: red !important;text-decoration:line-through;}
.folder_c1 {width:80px;}
.folder_c2 {width:100%;}
.childFolder {width:200px;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}
#compDept table {width:100%;table-layout:fixed;border-collapse:collapse;margin-top:4px;}
#compDept table tr td {border:solid;border-color:#EEE;border-width:1px;padding:4px;}
#listEmployee {padding-top:4px;}
        </style>
        <script type="text/javascript">
//<![CDATA[
function nameFilter_Keyup() {
    var nameFilterLast = $('#nameFilterLast').val();
    var nameFilter = $('#nameFilter').val();
    if (nameFilterLast == nameFilter)
        return false;
    $('#nameFilterLast').val(nameFilter);
    return true;
}
//]]>
        </script>
    </ui:define>
    <ui:define name="content">
        <p:panel header="#{orgManagement.pageTitle}">
            <h:form id="form" prependId="false">
                <ui:include src="inc_submenu.xhtml"/>
                <hr/>
                <ui:include src="inc_compDept.xhtml"/>
                <br/>
                <p:fieldset legend="#{msgOrgmgmt['orgmgmt.fieldset.employeelist']}">
                    <h:outputLabel value="#{msgOrgmgmt['orgmgmt.label.employeenamefilter']}: "/>
                    <p:inputText id="nameFilter"
                                 value="#{orgManagement.nameFilter}"
                                 title="#{msgOrgmgmt['orgmgmt.label.employeenamefilter.tip']}"
                                 size="30">
                        <p:ajax event="keyup"
                                onstart="return nameFilter_Keyup()"
                                listener="#{orgManagement.nameFilterChange}"
                                update=":form:listEmployee"
                                global="off"/>
                    </p:inputText>
                    <input type="HIDDEN" id="nameFilterLast"/>
                    <p:dataTable id="listEmployee"
                                 value="#{orgManagement.employeeFiltered}"
                                 var="row"
                                 rows="10"
                                 paginator="true">
                        <p:column sortBy="#{row.orgCompany.name}">
                            <f:facet name="header">#{msgOrgmgmt['orgmgmt.label.company']}</f:facet>
                            <h:outputText value="#{row.orgCompany.name}"
                                          styleClass="#{orgManagement.isNodeActive(row.orgCompany) ? '' : 'inactive'}"/>
                        </p:column>
                        <p:column sortBy="#{row.orgDepartment.code}">
                            <f:facet name="header">#{msgOrgmgmt['orgmgmt.label.department']}</f:facet>
                            <h:outputText value="#{row.orgDepartment.code} #{row.orgDepartment.name}"
                                          styleClass="#{orgManagement.isNodeActive(row.orgDepartment) ? '' : 'inactive'}"/>
                        </p:column>
                        <p:column sortBy="#{row.code}">
                            <f:facet name="header">#{msgOrgmgmt['orgmgmt.label.employeecode']}</f:facet>
                            <h:outputText value="#{row.code}"/>
                        </p:column>
                        <p:column sortBy="#{row.name}">
                            <f:facet name="header">#{msgOrgmgmt['orgmgmt.label.employee']}</f:facet>
                            <h:outputText value="#{row.name}"
                                          styleClass="#{orgManagement.isNodeActive(row) ? '' : 'inactive'}"/>
                        </p:column>
                        <p:column sortBy="#{row.email}">
                            <f:facet name="header">#{msgOrgmgmt['orgmgmt.label.email']}</f:facet>
                            <h:outputText value="#{row.email}"/>
                        </p:column>
                        <p:column sortBy="#{row.adaccount}">
                            <f:facet name="header">#{msgOrgmgmt['orgmgmt.label.adaccount']}</f:facet>
                            <h:outputText value="#{row.adaccount}"/>
                        </p:column>
                    </p:dataTable>
                </p:fieldset>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>