<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <h:panelGrid columns="2">
        <p:fileUpload rendered="#{!attachmentController.readonly}"
                      label="Upload" 
                      multiple="true" 
                      auto="true" 
                      update="reportFileInfo"
                      fileUploadListener="#{attachmentController.handleFileUpload}"/>
        <h:panelGroup id="reportFileInfo">
            <h:panelGrid columns="2">
                <table>
                    <ui:repeat value="#{attachmentController.attachmentVOList}"
                               var="attachmentVO">
                        <tr>
                            <td>
                                <h:commandLink value="#{attachmentVO.fileName}"
                                               target="downloadFile"
                                               actionListener="#{attachmentController.downloadAction(attachmentVO)}"
                                               >
                                    <p:fileDownload value="#{attachmentController.downloadFile}"/>
                                </h:commandLink>
                            </td>
                            <td style="text-align:right;">
                                <h:outputText value="#{attachmentVO.size}"/>
                            </td>
                            <td>
                                <h:outputText value="bytes"/>
                            </td>
                            <td>
                                <p:commandLink action="#{attachmentController.remove(attachmentVO)}"
                                               rendered="#{!attachmentController.readonly}"
                                               update="reportFileInfo">
                                    <h:graphicImage title="移除"
                                                    library="images" 
                                                    name="delete.png"
                                                    />
                                </p:commandLink>
                            </td>
                        </tr>
                    </ui:repeat>
                </table>
            </h:panelGrid>
        </h:panelGroup>
    </h:panelGrid>
</ui:composition>
