<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/generalPageTemplate.xhtml">
    <ui:define name="title">#{msgApp['irs.msg.txt53']}</ui:define>
    <ui:define name="head">
    </ui:define>
    <ui:define name="content">
        <p:panel header="#{msgApp['irs.msg.txt53']}">
            <h:form id="form" prependId="false">
                    <h:panelGroup >
                        <p:selectOneMenu id="somGroup" value="#{companyTypeController.group}">
                            <f:selectItems value="#{companyTypeController.groups}"/>
                            <p:ajax oncomplete="doChangeGroup()" />
                        </p:selectOneMenu>
                        <p:remoteCommand name="doChangeGroup"
                                         actionListener="#{companyTypeController.changeGroup()}"
                                         update=":form"/>
                        <!--<br/>-->
                        <p:spacer width="50"/>
                        <h:outputLabel  value="#{msgApp['irs.msg.txt8']}:" escape="false" />
                        <p:selectOneMenu 
                            converter="fcCompanyConverter"
                            value="#{companyTypeController.editCompany}">
                            <f:selectItems value="#{companyTypeController.allCompanyOptions}" />
                        </p:selectOneMenu>
                        <p:spacer width="50"/>
                        <h:outputLabel  value="#{msgApp['irs.msg.txt54']}:" escape="false" />
                        <p:selectOneMenu id="somType" value="#{companyTypeController.typeEnum}">
                            <f:selectItems value="#{companyTypeController.typeEnums}"/>
                            <p:ajax oncomplete="doChangeGroup()" />
                        </p:selectOneMenu>
                        <p:commandLink action="#{companyTypeController.replaceType()}"
                                       update="itType">
                            <h:graphicImage title="#{msgApp['app.button.inputOptions']}"
                                            library="images" height="18" width="18"
                                            name="1rightarrow.png"/>
                        </p:commandLink>
                        <p:spacer width="10"/>
                        <p:inputText id="itType" value="#{companyTypeController.editType}" 
                                     size="20" />
                         <br/>
                        <h:panelGroup style="display:block;">
                            <p:commandButton value="#{msgApp['app.button.add']}"
                                             icon="ui-icon-circle-check"
                                             action="#{companyTypeController.add()}"
                                             update="dtCompanyTypeList"/>
                        </h:panelGroup>
                    </h:panelGroup>
                <p:fieldset legend="#{msgApp['app.fieldset.queryresult']}" rendered="#{!companyTypeController.noPermission}">
                    <p:dataTable id="dtCompanyTypeList"
                                 value="#{companyTypeController.companyTypeList}"
                                 var="row" style="width: 600px;"
                                 paginator="false">
                        <p:column headerText="ID" width="20" rendered="#{userSession.isUserInRole('ADMINISTRATORS')}">
                            <h:outputText value="#{row.id}"/>
                        </p:column>
                        <p:column headerText="#{msgApp['app.label.action']}" width="20">
                            <p:commandLink action="#{companyTypeController.initIrsCompanyTypeEdit(row)}"
                                           update=":formTypeEdit:typeEditGroup"
                                           oncomplete="PF('typeEditDlg').show()">
                                <h:graphicImage title="#{msgApp['irs.msg.txt53']}"
                                                library="images" height="18" width="18"
                                                name="page_edit.png"/>
                            </p:commandLink>
                            <p:commandLink onstart="return confirm('#{msgApp['app.confirm.remove']}')"
                                           actionListener="#{companyTypeController.remove(row)}"
                                           update="dtCompanyTypeList">
                                <h:graphicImage title="#{msgApp['app.button.remove']}"
                                                library="images" name="delete.png"/>
                            </p:commandLink>
                        </p:column>
                        <p:column headerText="#{msgApp['company.msg.txt2']}" width="50">
                            <h:outputText value="#{row.company.toString()}"/>
                        </p:column>
                        <p:column headerText="#{msgApp['irs.msg.txt54']}" width="100">
                            <h:outputText value="#{row.type}"/>
                        </p:column>
                    </p:dataTable>
                </p:fieldset>
            </h:form>
                
            <h:form id="formTypeEdit" prependId="false">
                <ui:include src="inc_editDlg.xhtml"/>
                <!--            <ui:include src="inc_irsUserEditDlg.xhtml"/>-->
            </h:form>
        </p:panel>            
    </ui:define>
</ui:composition>