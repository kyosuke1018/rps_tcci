<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <h:form id="fmSelectDealer" prependId="false" >
        <!-- 設定對話框 -->
        <p:dialog header="#{msg['common.set.dlg']}" id="dlgSelectDealer" 
                  styleClass="rwdDlg"
                  widgetVar="wvSelectDealer" resizable="true"
                  responsive="true" 
                  modal="true" draggable="true" 
                  showEffect="clip" hideEffect="clip" >
            <!-- 選取經銷商 -->
            <p:outputLabel value="#{msg['msg.txt006']}："></p:outputLabel>
            <p:panel style="max-height:300px;overflow-y:auto;">
                <div class="ui-fluid" >
                    <p:repeat value="#{downstream.dealers}" var="row" >
                        <div class="ui-grid-col-6">
                            <p:selectBooleanCheckbox value="#{row.selected}" ></p:selectBooleanCheckbox>
                            <p:spacer width="5" height="5" />
                            <p:outputLabel value="#{row.dealerLabel}" />
                        </div>
                    </p:repeat>
                </div>
            </p:panel>
            <h:panelGroup styleClass="blockBtnC" >
                <!-- 確定 -->
                <p:commandButton icon="ui-icon-disk" value="#{msg['button.confirm']}" 
                                 styleClass="btnS"
                                 actionListener="#{downstream.selectDealers()}" 
                                 oncomplete="handleAfterSave(xhr, status, args, true, '.topOfResult', 0);" 
                                 update=":fmMain:plEdit" >
                </p:commandButton>
                <!-- 取消 -->
                <p:commandButton icon="ui-icon-cancel" value="#{msg['button.cancel']}" 
                                 styleClass="btnS" 
                                 type="button" 
                                 onclick="closeSelectDealerDlg()"
                                 immediate="true" 
                                 >
                </p:commandButton>
            </h:panelGroup>
        </p:dialog>
    </h:form>
    
    <script type="text/javascript">
        //<![CDATA[
        function openSelectDealerDlg(xhr, status, args){
            if( afterCallBackHandler(xhr, status, args) ){
                PF('wvSelectDealer').show();
            }
        }
        function closeSelectDealerDlg(){
            PF('wvSelectDealer').hide();
        }
        function handleAfterSave(xhr, status, args) {
            if( afterCallBackHandler(xhr, status, args) ){
                closeSelectDealerDlg();
            }
        }
        //]]>
    </script>
</ui:composition>
