<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="../templates/generalPageTemplate.xhtml">
    <ui:define name="title">
        #{msg['menu.check.maintenance']}
    </ui:define>    
    <ui:define name="content">
        <h:form prependId="false">
            <p:panel header="#{msg['menu.check.maintenance']}">
                <p:fieldset id="checkMasterProperties" legend="#{msg['check.properties']}:">
                    <h:panelGrid columns="4" width="100%">
                        <h:outputLabel value="#{msg['check.number']}:" styleClass="required"/>
                        <h:inputText readonly="#{ checkMasterMaintenanceController.previousPage eq 'check_query.xhtml' }" 
                                     value="#{checkMasterMaintenanceController.checkMaster.checkNumber}"
                                     styleClass="ui-inputfield ui-state-default"/>
                        <h:outputLabel value="#{msg['remit.label.customer']}:" styleClass="required"/>
                        <h:panelGroup>
                            <h:selectOneMenu rendered="#{checkMasterMaintenanceController.previousPage eq 'check_query.xhtml'}" 
                                             value="#{checkMasterMaintenanceController.selectedCustomerFromAR}"
                                             >
                                <f:selectItems var="item" 
                                               value="#{checkMasterMaintenanceController.customerFromARList}" 
                                               itemLabel="#{item.displayIdentifier}" 
                                               itemValue="#{item.simpleCode}"/>
                            </h:selectOneMenu>
                            <p:autoComplete id="customer_code" 
                                            value="#{selectCustomerController.selectedCustomer}"
                                            var="code"
                                            itemLabel="#{code}"
                                            itemValue="#{code}"
                                            completeMethod="#{selectCustomerController.completeMethod}"
                                            maxResults="10"
                                            queryDelay="500"
                                            minQueryLength="3" 
                                            rendered="#{checkMasterMaintenanceController.previousPage ne 'check_query.xhtml'}"
                                            >
                                <p:column style="width: 100%">
                                    #{code} - #{selectCustomerController.getCustomerName(code)}
                                </p:column>
                                <p:ajax event="itemSelect" 
                                        listener="#{selectCustomerController.handleSelect}"
                                        update="customer_name"
                                        />
                            </p:autoComplete>
                            <p:spacer width="5px" rendered="#{checkMasterMaintenanceController.previousPage ne 'check_query.xhtml'}"/>
                            <p:commandButton action="#{selectCustomerController.init}"
                                             oncomplete="PF('selectCustomerDlg').show();"
                                             immediate="true"
                                             value="..."
                                             update="customerCode customerName customerSearchResult"
                                             rendered="#{checkMasterMaintenanceController.previousPage ne 'check_query.xhtml'}"/>
                            <h:outputLabel id="customer_name" value="#{selectCustomerController.name}"
                                           rendered="#{checkMasterMaintenanceController.previousPage ne 'check_query.xhtml'}"/>
                        </h:panelGroup>
                        <h:outputLabel value="#{msg['check.billing.account']}:" styleClass="required"/>
                        <!--
                        <h:inputText value="#{checkMasterMaintenanceController.checkMaster.billingAccount}"
                                     styleClass="ui-inputfield ui-state-default"/>
                        -->
                        <p:autoComplete id="selectedAccountCode"
                                            value="#{checkMasterMaintenanceController.checkMaster.billingAccount}"
                                            var="billingAccount"
                                            itemLabel="#{billingAccount}"
                                            itemValue="#{billingAccount}"
                                            completeMethod="#{checkMasterMaintenanceController.findBillingAccount}"
                                            >
                            <p:ajax event="itemSelect" 
                                        listener="#{checkMasterMaintenanceController.findBank}" 
                                        update="selectedBankCode selectedBankName"/>
                        </p:autoComplete>
                        <h:outputLabel value="#{msg['check.bank.name']}:" styleClass="required"/>
                        <h:panelGroup>
                            <p:autoComplete id="selectedBankCode"
                                            value="#{checkMasterMaintenanceController.bankCode}"
                                            var="bankCode"
                                            itemLabel="#{bankCode}"
                                            itemValue="#{bankCode}"
                                            completeMethod="#{checkMasterMaintenanceController.completeBank}"
                                            >
                                <p:ajax event="itemSelect" 
                                        listener="#{checkMasterMaintenanceController.handleSelect}"
                                        update="selectedBankCode selectedBankName"/>
                                <p:column>
                                    #{bankCode} - #{checkMasterMaintenanceController.findBankName(bankCode)}
                                </p:column>
                            </p:autoComplete>
                            <p:spacer width="5px"/>
                            <p:commandButton value="#{msg['button.browse']}" 
                                             oncomplete="PF('selectBankDlg').show();return false;" 
                                             action="#{selectBankController.init}"
                                             update="bankCriteria bankSearchResult"/>
                            <h:outputText id="selectedBankName" value="#{checkMasterMaintenanceController.bankName}"/>
                        </h:panelGroup>
                        <h:outputLabel value="#{msg['check.billing.amount']}:" styleClass="required"/>
                        <h:inputText value="#{checkMasterMaintenanceController.checkMaster.amount}"
                                     styleClass="ui-inputfield ui-state-default"/>
                        <h:outputLabel value="#{msg['check.duedate']}:" styleClass="required"/>
                        <p:calendar value="#{checkMasterMaintenanceController.checkMaster.dueDate}" pattern="yyyyMMdd" showOn="button" />  
                        <h:outputLabel value="#{msg['common.label.modifier']}:" 
                                       for="modifier"
                                       rendered="#{checkMasterMaintenanceController.checkMaster.modifier ne null}"/>
                        <h:outputText id="modifier" 
                                      value="#{checkMasterMaintenanceController.checkMaster.modifier.displayIdentifier}"
                                      rendered="#{checkMasterMaintenanceController.checkMaster.modifier ne null}"/>
                        <h:outputLabel value="#{msg['common.label.modifytimestamp']}:" 
                                       for="modifytimestamp"
                                       rendered="#{checkMasterMaintenanceController.checkMaster.modifier ne null}"/>
                        <h:outputText id="modifytimestamp" 
                                      value="#{checkMasterMaintenanceController.checkMaster.modifytimestamp}"
                                      rendered="#{checkMasterMaintenanceController.checkMaster.modifier ne null}">
                            <f:convertDateTime pattern="yyyy/MM/dd HH:mm:ss"/>
                        </h:outputText>
                    </h:panelGrid>
                    <h:panelGrid columns="1" width="100%">
                        <h:panelGroup>
                            <p:commandButton action="#{checkMasterMaintenanceController.doSaveCheckMasterAction}" 
                                             value="#{msg['button.save']}"
                                             ajax="false"/>
                            <p:spacer width="5px"/>
                            <p:commandButton action="#{checkMasterMaintenanceController.cancel}"
                                             value="#{msg['button.cancel']}"
                                             ajax="false"
                                             immediate="true"/>
                        </h:panelGroup>                        
                    </h:panelGrid>
                </p:fieldset>
            </p:panel>    
        </h:form>
        <ui:include src="../jsff/selectCustomerDlg.xhtml">
            <ui:param name="customerCodeId" value=":customer_code"/>
            <ui:param name="customerNameId" value=":customer_name"/>
        </ui:include>
        <ui:include src="../jsff/selectBankDlg.xhtml"/>
    </ui:define>    
</ui:composition>