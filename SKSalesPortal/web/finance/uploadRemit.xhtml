<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="../templates/generalPageTemplate.xhtml">
    <ui:define name="title">
        #{msg['remit.title.uploadRemit']}
    </ui:define>    
    <ui:define name="content">
        <h:form prependId="false">
            <p:panel header="#{msg['remit.title.uploadRemit']}">
                <p:fieldset legend="#{msg['common.fieldset.criteria']}:">
                    <h:panelGrid columns="4" width="100%">
                        <h:outputLabel value="#{msg['remit.label.approveDate']}:" for="date"/>
                        <h:panelGroup id="date">
                            <p:calendar id="beginDate" 
                                        navigator="true"
                                        showOn="button" 
                                        pattern="yyyy/MM/dd" 
                                        size="16"
                                        value="#{uploadRemitController.filter.reviewDateStart}" 
                                        />
                            ~ 
                            <p:calendar id="endDate" 
                                        navigator="true"
                                        showOn="button" 
                                        pattern="yyyy/MM/dd" 
                                        size="16"
                                        value="#{uploadRemitController.filter.reviewDateEnd}" 
                                        />
                        </h:panelGroup>
                        <h:outputLabel value="#{msg['remit.label.status']}:" for="status"/>
                        <h:selectOneMenu id="status" value="#{uploadRemitController.filter.status}">
                            <f:selectItem itemLabel="全部" itemValue="#{null}"/>
                            <f:selectItems value="#{uploadRemitController.statusList}"/>
                        </h:selectOneMenu>
                        <h:outputLabel value="#{msg['remit.label.approver']}:" for="creatorGroup"/>
                        <h:panelGroup id="creatorGroup">
                            <p:autoComplete id="empId" value="#{selectEmployeeController.selectedUser}"
                                            maxResults="10"
                                            var="empId"
                                            itemLabel="#{empId}"
                                            itemValue="#{empId}"
                                            completeMethod="#{selectEmployeeController.completeMethod}"
                                            >
                                <p:ajax event="itemSelect" 
                                        listener="#{selectEmployeeController.handleSelect}"
                                        update="empName"/>
                                <p:column>
                                    #{empId} - #{selectEmployeeController.getUserCname(empId)}
                                </p:column>
                            </p:autoComplete>
                            <p:spacer width="5px"/>
                            <p:commandButton action="#{selectEmployeeController.init}"
                                             oncomplete="PF('selectEmployeeDialog').show()"
                                             value="..."
                                             update="SED_selects employeeListGroup"
                                             />
                            <h:outputLabel id="empName" value="#{selectEmployeeController.cname}"/>
                            <h:inputHidden binding="#{selectEmployeeController.initUserBySessionUserHidden}"/>
                        </h:panelGroup>
                    </h:panelGrid>   
                    <p:commandButton value="#{msg['button.search']}" 
                                     icon="ui-icon-search"
                                     action="#{uploadRemitController.query}" 
                                     update="searchResult empName" />
                </p:fieldset>
                <p:fieldset id="searchResult" legend="#{msg['common.fieldset.result']}:">
                    <ui:include src="../jsff/remitQueryResult.xhtml"/>
                    <p:commandButton value="#{msg['button.upload']}"
                                     action="#{uploadRemitController.prepareUpload(remitQueryController.remitMasterVOList)}"
                                     oncomplete="fiInterfaceDialog_showComplete(xhr, status, args);"
                                     update="messages growl fiInterfaceDialog remitResultList"
                                     icon="ui-icon-arrowthick-1-n"/>
                </p:fieldset>
            </p:panel>
        </h:form>
        <ui:include src="../jsff/selectEmployeeDialog.xhtml">
            <ui:param name="empidId" value="empId"/>
            <ui:param name="empnameId" value="empName"/>
        </ui:include>
        <ui:include src="../jsff/ajaxStatusDlg.xhtml"/>
        <ui:include src="../jsff/viewFiInterfaceDialog.xhtml">
            <ui:param name="sourceList" value="searchResult"/>
        </ui:include>
    </ui:define>    
</ui:composition>