<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="../../templates/generalPageTemplate.xhtml">
    <ui:define name="title">
        #{msg['menu.sales.report.sales.return.discount']}
    </ui:define>    
    <ui:define name="content">
        <h:form prependId="false">
            <p:panel header="#{msg['menu.sales.report.sales.return.discount']}">
                <p:fieldset legend="#{msg['search.criteria']}:" id="searchCriteria">
                    <ui:include src="selectSalesOrderTimestamp.xhtml"/>
                    <h:panelGrid columns="1" width="100%">
                        <h:panelGroup>
                            <p:commandButton value="#{msg['button.search']}" action="#{salesReturnDiscountReportController.doSearch}" update="searchCriteria searchResultGroup messages" />                                          
                            <p:commandButton icon="ui-icon-disk"
                                             value="#{msg['button.excel']}"
                                             ajax="false"
                                             title="匯出全部"
                                             style="margin-left: 10px; vertical-align: bottom"
                                             rendered="#{salesReturnDiscountReportController.salesReturnDiscountList ne null}">
                                <p:dataExporter type="xls" target="tbl" fileName="salesReturnDiscount" 
                                                postProcessor="#{salesReturnDiscountReportController.postProcessXLS}"/>  
                            </p:commandButton>
                        </h:panelGroup>                 
                    </h:panelGrid>                    
                </p:fieldset>
                <h:panelGroup id="searchResultGroup" >
                <p:fieldset id="searchResult" legend="#{msg['search.result']}:" rendered="#{salesReturnDiscountReportController.salesReturnDiscountList ne null}">
                    <p:dataTable id="tbl" rows="20" value="#{salesReturnDiscountReportController.salesReturnDiscountList}" var="row" paginator="true"> 
                        <p:column headerText="#{msg['buyer']}" style="text-align:left">
                            <h:outputText value="#{row.buyer}"/>                             
                        </p:column>                      
                        <p:column headerText="#{msg['recognize.date']}" style="text-align:left">
                            <h:outputText value="#{row.invoiceDateStr}"/>
                        </p:column>                        
                        <p:column headerText="#{msg['billing.doc']}" style="text-align:left">
                            <h:outputText value="#{row.billingDoc}"/>
                        </p:column>                       
                        <p:column headerText="#{msg['sales.order.number']}" style="text-align:left">
                            <h:outputText value="#{row.orderNumber}"/>                                
                        </p:column>
                        <p:column headerText="#{msg['invoice.number']}" style="text-align:left">
                            <h:outputText value="#{row.invoiceNumber}"/>                              
                        </p:column>
                        <p:column headerText="#{msg['materiel']}" style="text-align:left">
                            <h:outputText value="#{row.product}"/>                             
                        </p:column>
                        <p:column headerText="#{msg['price']}" style="text-align:right">
                            <h:outputText value="#{row.price}">
                                <f:convertNumber groupingUsed="true"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="#{msg['quantity']}" style="text-align:right">
                            <h:outputText value="#{row.quantity}">
                                <f:convertNumber groupingUsed="true"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="#{msg['notax.amount']}" style="text-align:right">
                            <h:outputText value="#{row.amount}">
                                <f:convertNumber groupingUsed="true"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="#{msg['tax']}" style="text-align:right">
                            <h:outputText value="#{row.tax}">
                                <f:convertNumber groupingUsed="true"/>
                            </h:outputText>
                        </p:column>                        
                    </p:dataTable>
                </p:fieldset>
              </h:panelGroup>         
            </p:panel>    
        </h:form>
        <ui:include src="../../jsff/ajaxStatusDlg.xhtml"/>        
    </ui:define>    
</ui:composition>