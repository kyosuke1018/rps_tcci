<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <p:panel rendered="#{paymentItemReportController.paymentItemList ne null}">
        <p:commandButton icon="ui-icon-disk"
                         value="#{msg['button.excel']}"
                         ajax="false"
                         title="匯出全部">
            <p:dataExporter type="xls" target="paymentItemtbl" fileName="paymentItem" 
                            postProcessor="#{paymentItemReportController.postProcessXLS}"
                            excludeColumns="10"/>  
        </p:commandButton>
    </p:panel>
    <p:dataTable id="paymentItemtbl" value="#{paymentItemReportController.paymentItemList}" var="row"
                 rows="20" paginator="true">
        <p:column headerText="#{msg['paymentItem.baselineTimestamp']}" >
            <h:outputText value="#{row.baselineTimestamp}">
                <f:convertDateTime pattern="yyyy/MM"/>
            </h:outputText>
        </p:column>  
        <p:column headerText="#{msg['paymentItem.arAmount']}" style="text-align:right">
            <h:outputText value="#{row.arAmount}">
                <f:convertNumber groupingUsed="true"/>
            </h:outputText>
        </p:column>                            
        <p:column headerText="#{msg['paymentItem.premiumDiscount']}"   style="text-align:right">
            <h:outputText value="#{row.premiumDiscount}">
                <f:convertNumber groupingUsed="true"/>
            </h:outputText>
        </p:column>
        <p:column  headerText="#{msg['paymentItem.salesReturn']}"  style="text-align:right">
            <h:outputText value="#{row.salesReturn}">
                <f:convertNumber groupingUsed="true"/>
            </h:outputText>
        </p:column>
        <p:column  headerText="#{msg['paymentItem.salesDiscount']}"  style="text-align:right">
            <h:outputText value="#{row.salesDiscount}">
                <f:convertNumber groupingUsed="true"/>
            </h:outputText>
        </p:column>                                               
        <p:column headerText="#{msg['paymentItem.paymentAmount']}"  style="text-align:right">
            <h:outputText value="#{row.paymentAmount}">
                <f:convertNumber groupingUsed="true"/>
            </h:outputText>
        </p:column>   
        <p:column headerText="#{msg['paymentItem.orderNumber']}">
            <h:outputText value="#{row.orderNumber}"/>
        </p:column>  
        <p:column headerText="#{msg['paymentItem.invoiceNumber']}">
            <h:outputText value="#{row.invoiceNumber}"/>                               
        </p:column>
        <p:column headerText="#{msg['paymentItem.customer.code']}" >
            <h:outputText value="#{row.customer.code}"/>
        </p:column>   
        <p:column headerText="#{msg['paymentItem.customer.name']}">
            <h:outputText value="#{row.customer.name}"/>
        </p:column>
    </p:dataTable>
</ui:composition>