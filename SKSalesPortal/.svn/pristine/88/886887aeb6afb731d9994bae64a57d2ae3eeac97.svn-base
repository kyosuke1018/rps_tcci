<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <script language='javascript'>
        function resetValue(input) {
            input.value = '';
        }
    </script>
    <h:form prependId="false">
        <p:dialog id="editQuotationMailGroupDialog"
                  widgetVar="editQuotationMailGroupDialogVar"
                  header="#{quotationMailGroup.editTitle}"
                  resizable="false"
                  modal="true">

            <h:panelGrid columns="4" style="width: 100%">
                <h:outputLabel value="#{msg['quotation.mailGroup.name']}:"
                               for="name"
                               styleClass="required"/>
                <p:inputText id="name"
                             value="#{quotationMailGroup.selected.name}"
                             size="30"
                             />
                <p:spacer height="1"/>
                <p:spacer height="1"/>
                <h:outputLabel value="#{msg['quotation.mailGroup.member']}:"
                               for="member"
                               styleClass="required"/>
                <h:panelGroup>
                    <p:autoComplete id="member"
                                    value="#{quotationMailGroup.selectedMember}"
                                    completeMethod="#{quotationMailGroup.completeMember}"
                                    itemValue="#{member}"
                                    itemLabel="#{member}"
                                    size="50"
                                    var="member"
                                    >
                        <p:column>
                            <h:outputText value="#{quotationMailGroup.getMemberDisplayIdentifier(member)}"/>
                        </p:column>
                        <p:ajax event="itemSelect" listener="#{quotationMailGroup.selectMember}"
                                update="memberGroup"
                                oncomplete="resetValue(document.getElementById('member_input'));"/>
                    </p:autoComplete>    
                    <p:watermark value="#{msg['quotation.mailGroup.member.watermark']}" for="member"/>
                    <h:panelGroup id="memberGroup">
                        <p:dataTable id="memberList" value="#{quotationMailGroup.memberList}"
                                     var="member"
                                     rows="7"
                                     paginator="true"
                                     paginatorPosition="bottom"
                                     >
                            <p:column headerText="#{msg['common.label.action']}">
                                <p:commandLink value="#{msg['button.remove']}"
                                               action="#{quotationMailGroup.removeMember(member)}"
                                               update="memberGroup"
                                               immediate="true"
                                               />
                            </p:column>
                            <p:column headerText="#{msg['quotation.mailGroup.member']}">
                                <h:outputText value="#{member.displayIdentifier}"
                                              style="float: left;"/>
                            </p:column>
                        </p:dataTable>
                    </h:panelGroup>
                </h:panelGroup>
                <h:outputLabel value="#{msg['quotation.mailGroup.user']}:"
                               for="user"
                               styleClass="required"/>
                <h:panelGroup>
                    <p:autoComplete id="user"
                                    value="#{quotationMailGroup.selectedUser}"
                                    size="50"
                                    completeMethod="#{quotationMailGroup.completeUser}"
                                    itemLabel="#{user}"
                                    itemValue="#{user}"
                                    var="user">
                        <p:column>
                            #{quotationMailGroup.getUserDisplayIdentifier(user)}
                        </p:column>
                        <p:ajax event="itemSelect" listener="#{quotationMailGroup.selectUser}"
                                update="userGroup"
                                oncomplete="resetValue(document.getElementById('user_input'));"/>
                    </p:autoComplete>
                    <p:watermark for="user" value="#{msg['quotation.mailGroup.user.watermark']}"/>
                    <h:panelGroup id="userGroup">
                        <p:dataTable id="userList" value="#{quotationMailGroup.userList}"
                                     var="user"
                                     rows="7"
                                     paginator="true"
                                     paginatorPosition="bottom"
                                     >
                            <p:column headerText="#{msg['common.label.action']}">
                                <p:commandLink value="#{msg['button.remove']}"
                                               action="#{quotationMailGroup.removeUser(user)}"
                                               update="userGroup"
                                               immediate="true"
                                               />
                            </p:column>
                            <p:column headerText="#{msg['quotation.mailGroup.user']}"
                                      >
                                <h:outputText value="#{user.displayIdentifier}" style="float:left;"/>
                            </p:column>
                        </p:dataTable>
                    </h:panelGroup>
                </h:panelGroup>
            </h:panelGrid>
            <h:panelGrid columns="1" style="width:100%; text-align: center;">
                <h:panelGroup>
                    <p:commandButton value="#{msg['button.save']}"
                                     action="#{quotationMailGroup.save}"
                                     oncomplete="editQuotaionMailGroupDialog_okcomplete(xhr,status,args)"
                                     update="datalist :messages :growl"/>
                    <p:spacer width="5"/>
                    <p:commandButton value="#{msg['button.cancel']}"
                                     immediate="true"
                                     onclick="PF('editQuotationMailGroupDialogVar').hide();"/>
                </h:panelGroup>
            </h:panelGrid>
        </p:dialog>
    </h:form>
</ui:composition>