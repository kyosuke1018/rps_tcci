<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/generalPageTemplate.xhtml">
    <ui:define name="title">客戶歷史出貨資料查詢</ui:define>
    <ui:define name="content">
        <p:panel header="客戶歷史出貨資料查詢" >
            <h:form id="form" prependId="false">    
                <p:fieldset legend="#{msgApp['app.fieldset.queryfilter']}">    
                    <h:panelGrid columns="4" width="100%">
                        <h:outputLabel value="#{msgApp['app.label.customerCode']}" /> 
<!--                            <p:autoComplete 
                            id="code"                                    
                            minQueryLength="3"   
                            value="#{zorderCnController.code}"
                            var="code"
                            itemLabel="#{code}"
                            itemValue="#{code}"
                            completeMethod="#{zorderCnController.completeMethod}"
                            maxResults="9"
                            >
                            <p:column>
                                #{code} - #{zorderCnController.getCustomerName(code)}
                            </p:column>
                            <p:ajax event="itemSelect" 
                                    listener="#{zorderCnController.handleSelect}"
                                    update=":form:code :form:name"
                                    />
                        </p:autoComplete>
                        <h:outputLabel value="#{msgApp['app.label.kuntx']}" 
                        <h:outputLabel id="name" value="#{zorderCnController.name}" /> -->
                        <h:selectOneMenu  value="#{zorderCnController.code}">
                            <f:selectItems  value="#{zorderCnController.customerList}" 
                                            var="ec"  itemLabel="#{ec.name}" itemValue="#{ec.code}" />
                        </h:selectOneMenu>        
                        
                        <h:outputLabel value="#{msgApp['app.label.plants']}" />
                        <h:selectOneMenu  value="#{zorderCnController.plantId}">
                            <f:selectItem itemValue="ALL" itemLabel="#{msgApp['app.label.selectAll']}"/>
                            <f:selectItems  value="#{zorderCnController.companys}" 
                                            var="zc"  itemLabel="#{zc.name}" itemValue="#{zc.code}" />
                        </h:selectOneMenu>
                        <h:outputLabel value="#{msgApp['app.label.dateSales.start']}"/>
                        <p:calendar locale="zh_TW" navigator="true" requiredMessage="#{zorderCnController.requireDateMsg}" required="true" pattern="yyyy/MM/dd" value="#{zorderCnController.dateStr}" readonlyInput="true" showOn="button" >
                        </p:calendar>
                        <h:outputLabel value="#{msgApp['app.label.dateSales.end']}"/>
                        <p:calendar locale="zh_TW" navigator="true" requiredMessage="#{zorderCnController.requireDateMsg}" required="true" pattern="yyyy/MM/dd" value="#{zorderCnController.dateStr1}" readonlyInput="true" showOn="button" >
                        </p:calendar>
                        <h:outputLabel value="#{msgApp['app.label.werks']}"  />
                        <h:selectOneMenu  value="#{zorderCnController.werks}">
                            <f:selectItem itemValue="ALL" itemLabel="#{msgApp['app.label.selectAll']}"/>
                            <f:selectItems  value="#{zorderCnController.zt001wCnList}" var="ztc"  itemLabel="#{ztc.name1}" itemValue="#{ztc.werks}" />
                        </h:selectOneMenu>
                        <h:outputLabel value="#{msgApp['app.label.bzirk']}"  />
                        <h:selectOneMenu  value="#{zorderCnController.bzirk}">
                            <f:selectItem itemValue="ALL" itemLabel="#{msgApp['app.label.selectAll']}"/>
                            <f:selectItems  value="#{zorderCnController.zt171CnList}" var="zt1"  itemLabel="#{zt1.bztxt}" itemValue="#{zt1.bzirk}" />
                        </h:selectOneMenu>             
                        <h:outputLabel value="#{msgApp['app.label.marktx']}"  />
                        <h:selectOneMenu  value="#{zorderCnController.matnr}">
                            <f:selectItem itemValue="ALL" itemLabel="#{msgApp['app.label.selectAll']}"/>
                            <f:selectItems  value="#{zorderCnController.zmaraCnList}" 
                                            var="zma"  itemLabel="#{zma.maktx}" itemValue="#{zma.matnr}" />
                        </h:selectOneMenu>
                        <h:outputLabel value="#{msgApp['app.label.inco1Tx']}"  /> 
                        <p:inputText  value="#{zorderCnController.inco1}"/>
                    </h:panelGrid>

                    <p:commandButton value="#{msgApp['app.button.query']}"
                                     action="#{zorderCnController.prepareList()}"
                                     icon="ui-icon-search"
                                     ajax="true"
                                     update=":form:panel"
                                     disabled="#{empty zorderCnController.customerList}"/>
                </p:fieldset>
                <p:fieldset legend="#{msgApp['app.fieldset.queryresult']}"> 
                    <h:panelGroup id="panel">
                        <p:dataTable id="dataTable" value="#{zorderCnController.items}" 
                                     var="item"
                                     paginator="true" rows="10"  
                                     paginatorPosition="bottom">
                            <f:facet name="header">  
                                <h:commandLink>
                                    <h:graphicImage library="images" name="excel_exports.png" />
                                    <p:dataExporter type="xls" target="dataTable" fileName="zOrderCn" postProcessor="#{zorderCnController.postProcessXLSZorderCn}"/>
                                    <h:outputText value="#{msgApp['app.label.export']}"/>
                                </h:commandLink>
                            </f:facet>  
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.kunnr']}"/>
                                </f:facet>
                                <h:outputText value="#{item.kunnr}" style="text-align: center; width: 100%;font-size: 8pt"/>
                                <f:facet name="footer">
                                    <h:outputText  value="#{zorderCnController.items.size() gt 0 ? msgZvSD['Label_sum']  : ''}" style="color: blue;font-size: 12pt;font-weight: bolder"/>
                                </f:facet>                                    
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.kunnrTx']}"/>
                                </f:facet>                                   
                                <h:outputText value="#{item.kunnrTx}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>                                
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.plant']}"/> 
                                </f:facet>
                                <h:outputText value="#{item.werksTx != null ? item.werksTx : item.werks}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.bztxt']}"/>
                                </f:facet>
                                <h:outputText value="#{item.bztxt}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.salesMember']}"/>
                                </f:facet>
                                <h:outputText value="#{item.ename}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.audat']}"/>
                                </f:facet>
                                <h:outputText value="#{item.audat}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.fkdat']}"/>
                                </f:facet>
                                <h:outputText value="#{item.fkdat}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.aubel']}"/>
                                </f:facet>
                                <h:outputText value="#{item.aubel}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.arktx']}"/>
                                </f:facet>
                                <h:outputText value="#{item.arktx}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.inco1Tx']}"/>
                                </f:facet>
                                <h:outputText value="#{item.inco1Tx}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.fkimg']}"/>
                                </f:facet>
                                <h:outputText style="float: right;font-size: 8pt"  value="#{item.fkimg}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                                <f:facet name="footer">
                                    <h:outputText  value="#{zorderCnController.items.size() gt 0 ? zorderCnController.sum_fkimg  : ''}"  
                                                   style="text-align: right; width: 100%; color: blue;font-weight: bolder;font-size: 8pt">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </f:facet>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.bezei']}"/>
                                </f:facet>
                                <h:outputText value="#{item.bezei}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>           
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.xblnr']}"/>
                                </f:facet>
                                <h:outputText value="#{item.xblnr}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.vgbel']}"/>
                                </f:facet>
                                <h:outputText value="#{item.vgbel}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.z4Desc']}"  /> 
                                </f:facet>
                                <h:outputText value="#{item.z4Desc}" style="text-align: center; 
                                              width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.changmat2']}"/>
                                </f:facet>
                                <h:outputText value="#{item.changmat2}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.uatbg']}"/>
                                </f:facet>
                                <h:outputText value="#{item.uatbg}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>      

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="#{msgApp['app.label.ktext']}"/>
                                </f:facet>
                                <h:outputText value="#{item.ktext}" style="text-align: center; width: 100%;font-size: 8pt"/>
                            </p:column>

                        </p:dataTable>
                    </h:panelGroup>
                </p:fieldset>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>