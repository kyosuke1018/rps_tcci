<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <h:form id="fmSelectFactory" prependId="false" >
        <!-- 選取廠別 -->
        <p:dialog header="選取廠別" id="dlgSelectFactory" 
                  styleClass="rwdDlg"
                  widgetVar="wvSelectFactory" resizable="true"
                  responsive="true"
                  width="400" 
                  modal="true" draggable="true" 
                  showEffect="clip" hideEffect="clip" >
            <!-- 選取廠別 -->
            <p:outputLabel value="選取廠別："></p:outputLabel>
            <p:panel style="max-height:300px;overflow-y:auto;">
                <div class="ui-fluid" >
                    <p:repeat value="#{selFactory.factorys}" var="row" >
                        <div class="ui-grid-col-6">
                            <p:selectBooleanCheckbox value="#{row.selected}" ></p:selectBooleanCheckbox>
                            <p:spacer width="5" height="5" />
                            <p:outputLabel value="#{row.displayLabel}" />
                        </div>
                    </p:repeat>
                </div>
            </p:panel>
            <h:panelGroup styleClass="blockBtnC" >
                <!-- 確定 -->
                <p:commandButton icon="ui-icon-disk" value="#{msg['button.confirm']}" 
                                 styleClass="btnS"
                                 actionListener="#{controller.selectFactorys()}" 
                                 oncomplete="handleAfterSave(xhr, status, args);"
                                 update="#{update}" >
                </p:commandButton>
                <!-- 取消 -->
                <p:commandButton icon="ui-icon-cancel" value="#{msg['button.cancel']}" 
                                 styleClass="btnS" 
                                 type="button" 
                                 onclick="closeSelectFactoryDlg()"
                                 immediate="true" 
                                 >
                </p:commandButton>
            </h:panelGroup>
        </p:dialog>
    </h:form>
    
    <script type="text/javascript">
        //<![CDATA[
        function openSelectFactoryDlg(xhr, status, args){
            if( afterCallBackHandler(xhr, status, args) ){
                PF('wvSelectFactory').show();
            }
        }
        function closeSelectFactoryDlg(){
            PF('wvSelectFactory').hide();
        }
        function handleAfterSave(xhr, status, args) {
            if( afterCallBackHandler(xhr, status, args) ){
                closeSelectFactoryDlg();
            }
        }
        //]]>
    </script>
</ui:composition>
