<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <!--參數
    target must ex.:approvalNoListForm:dataList
    fileName must ex.:materialList
    rowCount must ex.:materialList
    -->
    <h:commandLink rendered="#{(rowCount>0) and (rowCount lt 65535)}" onclick="autoStopBlockUI(5000);" style="cursor: pointer">
        <h:graphicImage library="images" name="excel.png" styleClass="icons" />
        <!-- 匯出報表 -->
        <h:outputLabel value="#{msg['label.export']}" style="cursor: pointer" />
        <p:dataExporter type="xls" target="#{target}" fileName="#{fileName}" 
                        postProcessor="#{controller.postProcessXLS}"
                        />
    </h:commandLink>

    <h:panelGroup rendered="#{rowCount gt 65535}">
        <h:graphicImage width="30" height="35" library="images" name="excel_gray.png" style="vertical-align: bottom; border-style: none" />
        <!-- 查詢結果已超出Excel檔案筆數限制(65535筆)無法匯出，請調整查詢條件 -->
        <h:outputLabel style="color: red" value="#{msg['label.maxExportMemo']}"/>
    </h:panelGroup>
    <p:spacer width="5px"/>
</ui:composition>