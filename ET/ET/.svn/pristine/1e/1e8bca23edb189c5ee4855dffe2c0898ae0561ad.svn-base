<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <!-- Document View & Edit Dialog -->
    <h:form id="editForm" >
        <!-- 跳出視窗 : 編輯視窗 -->
        <p:dialog header="編輯視窗" id="dlgEdit" widgetVar="wvDlgEdit" resizable="true"
                  modal="true" draggable="true" showEffect="clip" hideEffect="clip" >
            <p:fieldset >
                <p:panelGrid columns="2" columnClasses="pgCol1,pgCol2" >
                    <p:panelGrid columns="1" >
                        <p:panelGrid columns="3" >
                            <p:outputLabel value="分類：" />
                            <h:panelGroup >
                                <p:selectCheckboxMenu label="選取分類" id="smmCategorys" value="#{venderCategoryController.selectedCategorys}" 
                                                      filter="true" filterMatchMode="contains" panelStyle="width:480px" scrollHeight="400">
                                    <f:selectItems value="#{venderCategoryController.categoryOptionList}" var="item"   
                                                   itemLabel="#{item.label}" itemValue="#{item.value}" />
                                    <p:ajax event="change" update=":editForm:pgSelectedGroups" />
                                    <p:ajax event="toggleSelect" update=":editForm:pgSelectedGroups" />
                                </p:selectCheckboxMenu>
                            </h:panelGroup>
                            <p:spacer width="2" />
                            
                            <h:outputLabel value="client：" />
                            <h:outputText value="#{venderCategoryController.editVO.mandt}" />
                            <p:spacer width="2" />
                            <h:outputLabel value="供應商代碼：" />
                            <h:outputText value="#{venderCategoryController.editVO.venderCode}" />
                            <p:spacer width="2" />
                            <h:outputLabel value="供應商名稱：" />
                            <h:outputText value="#{venderCategoryController.editVO.cname}" />
                            <p:spacer width="2" />
                            
                        </p:panelGrid>
                    </p:panelGrid>
                    
                    <h:panelGroup id="pgSelectedGroups" >
                        <h:outputText value="已選取分類：" /><br/>
                        <p:scrollPanel style="width:350px;height:300px" mode="native" >
                            <ui:repeat value="#{venderCategoryController.selectedCategoryList}" var="item" >
                                <h:graphicImage library="images" name="1rightarrow.png" styleClass="icons" />
                                <h:outputText value="#{item.label}" /><br/>
                            </ui:repeat>
                        </p:scrollPanel>
<!--                        <p:scrollPanel style="width:350px;height:300px" mode="native" >
                            <ui:repeat value="#{usersController.selectedGroupList}" var="item" >
                                <h:graphicImage library="images" name="1rightarrow.png" styleClass="icons" />
                                <h:outputText value="#{item.code}-#{item.name}" /><br/>
                            </ui:repeat>
                        </p:scrollPanel>-->
                    </h:panelGroup>

                        
                </p:panelGrid>
                <p:separator /> 
                    
            </p:fieldset>　 
            <p:separator />
                
            <p:panelGrid columns="1" style="width:100%; text-align: center" >
                <h:panelGroup style="text-align: left" >
                    <p:messages id="messagesSave" showDetail="false" autoUpdate="true" />
                </h:panelGroup>
                <h:panelGroup id="pgEditSubmit" style="width:100%; text-align: center" >
<!--                    <p:commandButton id="cbApply"
                                     icon="ui-icon-disk"
                                     value="提交申請"
                                     actionListener="#{venderCategoryController.apply()}" 
                                     update=":fmMain"
                                     oncomplete="handleAfterSave(xhr, status, args);" />
                    <p:spacer width="10" />-->
                    <p:commandButton id="cbSave"
                                     icon="ui-icon-disk"
                                     value="儲存"
                                     actionListener="#{venderCategoryController.save()}" 
                                     update=":fmMain"
                                     oncomplete="handleAfterSave(xhr, status, args);" 
                                     rendered="#{venderCategoryController.isAdmin}" />
                    <p:spacer width="10" />
                    <p:commandButton id="cbClose" value="關閉" onclick="closeEditDlg();" 
                                     icon="ui-icon-circle-close"
                                     immediate="true" />
                </h:panelGroup>
            </p:panelGrid>
                
        </p:dialog>
    </h:form>
        
    <script type="text/javascript">
        //<![CDATA[
        function openEditDlg(){
            PF('wvDlgEdit').show();
        }
        function closeEditDlg(){
            PF('wvDlgEdit').hide();
        }
        function handleAfterSave(xhr, status, args) {
            //function handleAfterSave() {    
            if( handleCallBack(xhr, status, args) ){
                PF('wvDlgEdit').hide();
            }
        }
        //]]>
    </script>
</ui:composition>