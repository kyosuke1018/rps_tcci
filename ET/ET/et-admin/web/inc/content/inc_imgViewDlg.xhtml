<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <!-- 編輯對話框 -->
    <h:form id="showImgForm" >
        <p:dialog header="圖片展示#{(!imageController.multi)?' (點擊圖片關閉視窗)':''}" 
                  onShow="hideBodyScrollY();" onHide="showBodyScrollY();" 
                  position="center top" resizable="true" responsive="true" draggable="true" 
                  maximizable="true" minHeight="100" minWidth="150"  
                  width="720"
                  widgetVar="wvImgDlg" modal="true" >
            <h:panelGroup rendered="#{imageController.canShowImageDlg()}" >
                <!-- 單圖展示，點擊圖片關閉 -->
                <h:panelGroup rendered="#{!imageController.multi}" >
                    <p:commandLink type="button" onstart="closeImgViewDlg(); return false;" >
                        <h:graphicImage styleClass="showImg" url="#{imageController.viewImageUrl}&amp;imgType=B" 
                                        alt="#{imageController.imageVO.description}" title="#{imageController.imageVO.fileName}" />
                    </p:commandLink>
                </h:panelGroup>
            
                <!-- for 多圖展示 -->
                <h:panelGroup rendered="#{imageController.multi}" >
                    <h:panelGroup rendered="#{imageController.multi}" >
                        <p:galleria value="#{imageController.images}" var="image" panelWidth="700" panelHeight="500" showCaption="true">
                            <p:graphicImage styleClass="showImg" 
                                            url="#{imageController.genImageUrl(image, true, false)}&amp;imgType=B" 
                                            alt="#{image.description}" title="#{image.fileName}"/>
                        </p:galleria>
                    </h:panelGroup>
                    <p:separator />
                    <div style="width:100%; text-align: center;" >
                        <p:commandButton id="cbPhotosEditClose" value="關閉" immediate="true" 
                                         onstart="closeImgViewDlg(); return false;" 
                                         icon="ui-icon-circle-close" ></p:commandButton>
                    </div>
                </h:panelGroup>
            </h:panelGroup>
        </p:dialog>
    </h:form>

    <!-- for 多圖展示 -->
    <h:panelGroup rendered="#{!imageController.multi}" >
    <style>
      .showImg { /* set relative picture size */
        max-width: 100%;
        max-height: 100%;
        display: block;
        padding: 0;
        margin: 0;
        text-align: center; 
      }
    </style>
    <script type="text/javascript">
        //<![CDATA[
        // The image will also automatically resize when the client window is resized.
        function set_body_height() { // set body height = window height
          $('body').height($(window).height());
        }
        
        function closeImgViewDlg(){
            PF('wvImgDlg').hide();
        }
        
        $(document).ready(function() {
            $(window).bind('resize', set_body_height);
            set_body_height();
        });
        //]]>
    </script>
    </h:panelGroup>
</ui:composition>