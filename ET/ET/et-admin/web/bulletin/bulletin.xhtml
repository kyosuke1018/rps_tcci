<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                >
    <script type="text/javascript">
        //<![CDATA[
        function showBulletin(xhr, status, args){
            if( args.success !== undefined ){
                if( args.success ){
                    PF('contentViewDialog').show();
                    return true;
                }
            }
            if( args.msg !== undefined ){
                alert(args.msg);
            }
            
            return false;
        }
        //]]>
    </script>
    <style  type="text/css">
        .ui-paginator-top {
            display: none;
        }
    </style>
    <h:form prependId="false" id="queryForm">
        <!-- 公告事項 -->
        <p:panel header="#{msg['label.bulletin']}" style="margin-left:50px;width:500px;text-align:left;"> 
            <h:panelGroup id="bulletinGroup">
                <p:dataTable id="list" var="row" value="#{bulletinController.resultList}" 
                             styleClass="ui-datatable-hor-scroll"
                             widgetVar="wvDataTable" paginator="true" 
                             rows="5" rowIndexVar="rowIndex" >
                    <p:column width="110" style="text-align:center; #{row.ctype eq '1' ? 'background-color: yellow;' : ''}" >  
                        <f:facet name="header">
                            <!-- 更新日期 -->
                            <h:outputLabel style="white-space: nowrap;" value="#{msg['label.bulletin.date']}" />
                        </f:facet>
                        <h:outputText  style="text-align: right" value="#{row.dataDate}" >
                            <f:convertDateTime pattern="#{app.dateTimeFormat}"/>
                        </h:outputText>
                    </p:column>
                    <p:column width="160" style="text-align:center; #{row.ctype eq '1' ? 'background-color: yellow;' : ''}" >
                        <f:facet name="header">
                            <!-- 公告標題 -->
                            <h:outputLabel style="white-space: nowrap;" value="#{msg['label.bulletin.title']}" />
                        </f:facet>
                        <!-- 公告內容 -->
                        <p:commandLink value="#{row.title}" title="#{row.title} #{msg['label.bulletin.content']}"
                                       actionListener="#{bulletinController.view(row)}" 
                                       oncomplete="showBulletin(xhr, status, args);"  
                                       update=":queryForm:contentDialog" />
                    </p:column>
                    <p:column style="text-align:center; #{row.ctype eq '1' ? 'background-color: yellow;' : ''}" >
                        <f:facet name="header">
                            <!-- 公告內容 -->
                            <h:outputLabel style="white-space: nowrap;" value="#{msg['label.bulletin.content']}" />
                        </f:facet>
                        <!-- 公告內容 -->
                        <p:commandLink actionListener="#{bulletinController.view(row)}" 
                                       oncomplete="showBulletin(xhr, status, args);" 
                                       update=":queryForm:contentDialog" >
                            <h:graphicImage title="#{msg['label.bulletin.content']}" library="images" name="page_view.png" 
                                            style="vertical-align: bottom; border-style: none"/>
                        </p:commandLink>
                    </p:column>
                </p:dataTable>
            </h:panelGroup>
        </p:panel>
        
        <ui:include src="inc_bulletin_content.xhtml"></ui:include>
    </h:form>
</ui:composition>
