<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/generalPageTemplate.xhtml">
    <ui:define name="title">#{memberFormTodo.funcTitle}</ui:define>
    <ui:define name="content">
        <p:panel header="#{memberFormTodo.funcTitle}" style="overflow-x: scroll;" rendered="#{!memberFormTodo.functionDenied}" >
            <h:form id="form" prependId="false">
                <h:outputText value="* 點擊單號開啟簽核頁面。" styleClass="opinfo"/>
                <p:dataTable id="forms1"
                             value="#{memberFormTodo.forms}"
                             var="row"
                             paginator="true"
                             rows="5"
                             paginatorPosition="bottom"
                             tableStyle="table-layout: auto"
                             reflow="true">
                    <p:column headerText="單號" sortBy="#{row.id}" width="50">
                        <h:link value="#{row.id}"
                                target="#{empty target ? '_self':target}"
                                outcome="formSign.xhtml">
                            <f:param name="id" value="#{row.id}"/>
                            <f:param name="workitem" value="#{memberFormTodo.getWorkitemId(row)}"/>
                        </h:link>
                    </p:column>
                    <p:column headerText="申請類別">
                        <h:outputText value="#{memberFormTodo.formType(row.type)}"/>
                    </p:column>
                    <p:column headerText="申請人">
                        <h:outputText value="#{row.name}(#{row.email})"/>
                    </p:column>
                    <p:column headerText="廠別">
                        <h:outputText value="#{row.factoryName}"/>
                    </p:column>
                    <p:column headerText="申請供應商代碼">
                        <h:outputText value="#{row.applyVenderCode}"/>
                    </p:column>
                    <p:column headerText="申請供應商名稱">
                        <h:outputText value="#{row.applyVenderName}"/>
                    </p:column>
                        
                    <p:column headerText="狀態" sortBy="#{row.status}" width="50">
                        <h:outputText value="#{memberFormTodo.formStatus(row.status)}"/>
                    </p:column>
                    <p:column headerText="申請時間" sortBy="#{row.starttime}" width="50">
                        <h:outputText value="#{row.starttime}" 
                                      rendered="#{row.processId != null}">
                            <f:convertDateTime pattern="yyyy/MM/dd HH:mm"/>
                        </h:outputText>
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:panel>    
    </ui:define>
</ui:composition>